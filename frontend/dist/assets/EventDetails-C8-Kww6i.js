import{d as f,b,u as w,r as l,j as e,a as c}from"./index-BOMawjz4.js";function P(){const{eventId:i}=f(),y=b(),{user:n}=w(),[t,d]=l.useState(null),[p,g]=l.useState(!0),[o,x]=l.useState(null),[m,h]=l.useState(!1);l.useEffect(()=>{n&&i&&(async()=>{try{const a=await c.get(`/events/${i}`);d(a.data)}catch(a){x("Failed to fetch event details"),console.error(a)}finally{g(!1)}})()},[n,i]);const u=async()=>{var s,a;if(i){h(!0);try{await c.post(`/events/${i}/join`);const r=await c.get(`/events/${i}`);d(r.data)}catch(r){x(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to join event")}finally{h(!1)}}},N=async()=>{var s,a;if(i)try{await c.post(`/playlists/events/${i}/regenerate`);const r=await c.get(`/events/${i}`);d(r.data)}catch(r){x(((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.error)||"Failed to regenerate playlist")}};if(!n)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-600",children:"Please login to view event details"}),e.jsx("button",{onClick:()=>y("/login"),className:"btn btn-primary mt-4",children:"Login"})]});if(p)return e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})});if(o||!t)return e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-red-600",children:o||"Event not found"})});const v=t.participants.some(s=>s.id===n.id),j=t.creator.id===n.id;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t.name}),e.jsx("p",{className:"text-gray-600 mt-2",children:t.description})]}),!v&&!j&&t.isPublic&&e.jsx("button",{onClick:u,disabled:m,className:"btn btn-primary",children:m?"Joining...":"Join Event"})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Event Details"}),e.jsxs("dl",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Theme"}),e.jsx("dd",{className:"text-gray-900",children:t.theme})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Created by"}),e.jsx("dd",{className:"text-gray-900",children:t.creator.name})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Created on"}),e.jsx("dd",{className:"text-gray-900",children:new Date(t.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Visibility"}),e.jsx("dd",{className:"text-gray-900",children:t.isPublic?"Public":"Private"})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Participants"}),e.jsxs("ul",{className:"space-y-2",children:[t.participants.map(s=>e.jsx("li",{className:"text-gray-900",children:s.name},s.id)),t.participants.length===0&&e.jsx("li",{className:"text-gray-600",children:"No participants yet"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Playlist"}),j&&e.jsx("button",{onClick:N,className:"btn btn-secondary",children:"Regenerate Playlist"})]}),e.jsxs("div",{className:"space-y-4",children:[t.playlist.map((s,a)=>e.jsx("div",{className:"p-4 border border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"text-gray-500 w-8",children:[a+1,"."]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.artist}),s.album&&e.jsx("p",{className:"text-sm text-gray-500",children:s.album})]}),e.jsx("span",{className:"text-sm text-gray-500 capitalize",children:s.provider})]})},s.id)),t.playlist.length===0&&e.jsx("p",{className:"text-gray-600",children:"No songs in the playlist yet"})]})]})]})}export{P as default};
